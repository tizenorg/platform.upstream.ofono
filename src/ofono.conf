<!-- This configuration file specifies the required security policies
     for oFono core daemon to work. -->

<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>

  <!-- ../system.conf have denied everything, so we just punch some holes -->

  <policy user="root">
    <allow own="org.ofono"/>
    <allow own="org.ofono.PositioningRequestAgent"/>
    <allow own="org.ofono.HandsfreeAudioAgent"/>
    <allow own="org.ofono.PushNotificationAgent"/>
    <allow own="org.ofono.SmartMessagingAgent"/>
    <allow own="org.ofono.SimToolkitAgent"/>
    <allow send_destination="org.ofono"/>
    <allow send_interface="org.ofono.SimToolkitAgent"/>
    <allow send_interface="org.ofono.PushNotificationAgent"/>
    <allow send_interface="org.ofono.SmartMessagingAgent"/>
    <allow send_interface="org.ofono.PositioningRequestAgent"/>
    <allow send_interface="org.ofono.HandsfreeAudioAgent"/>
  </policy>

  <policy context="default">
    <check send_destination="org.ofono" send_interface="org.ofono.AssistedSatelliteNavigation"
	  privilege="http://tizen.org/privilege/location.enable"/>

    <check own="org.ofono.PositioningRequestAgent"
	  privilege="http://tizen.org/privilege/location.enable"/>

    <check send_destination="org.ofono" send_interface="org.ofono.AudioSettings"
	  privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.AudioSettings"
	  privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CallBarring"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.CallBarring"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallBarring"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CallForwarding"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallForwarding"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.CallForwarding"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallForwarding"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CallMeter"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.CallMeter"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallMeter"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallMeter"
	  receive_member="NearMaximumWarning" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CallSettings"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.CallSettings"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CallSettings"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CallVolume"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/volume.set"/>
    <allow send_destination="org.ofono" send_interface="org.ofono.CallVolume"
	  send_member="GetProperties"/>
    <allow receive_destination="org.ofono" receive_interface="org.ofono.CallVolume"
	  receive_member="PropertyChanged"/>

    <check send_destination="org.ofono" send_interface="org.ofono.CellBroadcast"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <allow receive_destination="org.ofono" receive_interface="org.ofono.CellBroadcast"
	  receive_member="EmergencyBroadcast"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CellBroadcast"
	  receive_member="IncomingBroadcast" privilege="http://tizen.org/privilege/message.read"/>
    <check send_destination="org.ofono" send_interface="org.ofono.CellBroadcast"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.CellBroadcast"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.ConnectionManager"
	  privilege="http://tizen.org/privilege/network.set"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.ConnectionManager"
	  receive_member="ContextAdded" privilege="http://tizen.org/privilege/network.set"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.ConnectionManager"
	  receive_member="ContextRemoved" privilege="http://tizen.org/privilege/network.set"/>
    <check send_destination="org.ofono" send_interface="org.ofono.ConnectionManager"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/network.profile"/>
    <check send_destination="org.ofono" send_interface="org.ofono.ConnectionManager"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/network.get"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.ConnectionManager"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/network.get"/>

    <check send_destination="org.ofono" send_interface="org.ofono.ConnectionContext"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/network.set"/>
    <check send_destination="org.ofono" send_interface="org.ofono.ConnectionContext"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/network.get"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.ConnectionContext"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/network.get"/>

    <check send_destination="org.ofono" send_interface="org.ofono.Handsfree"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.Handsfree"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check send_destination="org.ofono" send_interface="org.ofono.Handsfree"
	  send_member="RequestPhoneNumber" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.Handsfree"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.HandsfreeAudioManager"
	  send_member="Register" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.HandsfreeAudioManager"
	  send_member="Unregister" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.HandsfreeAudioManager"
	  send_member="GetCards" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.HandsfreeAudioManager"
	  receive_member="CardAdded" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.HandsfreeAudioManager"
	  receive_member="CardRemoved" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.HandsfreeAudioCard"
	  send_member="Connect" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.HandsfreeAudioCard"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.HandsfreeAudioCard"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check own="org.ofono.HandsfreeAudioAgent"
	  privilege="http://tizen.org/privilege/telephony.admin"/>

    <check send_destination="org.ofono" send_interface="org.ofono.LocationReporting"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/location"/>
    <check send_destination="org.ofono" send_interface="org.ofono.LocationReporting"
	  send_member="Request" privilege="http://tizen.org/privilege/network.set"/>
    <check send_destination="org.ofono" send_interface="org.ofono.LocationReporting"
	  send_member="Release" privilege="http://tizen.org/privilege/network.set"/>

    <check send_destination="org.ofono" send_interface="org.ofono.Manager"
	  privilege="http://tizen.org/privilege/network.get"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.Manager"
	  privilege="http://tizen.org/privilege/network.get"/>

    <check send_destination="org.ofono" send_interface="org.ofono.Message" send_member="Cancel"
	  privilege="http://tizen.org/privilege/message.write"/>
    <check send_destination="org.ofono" send_interface="org.ofono.Message"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.Message"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/message.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.MessageWaiting"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.MessageWaiting"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageWaiting"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.MessageManager"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.MessageManager"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageManager"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>
    <check send_destination="org.ofono" send_interface="org.ofono.MessageManager"
	  send_member="SendMessage" privilege="http://tizen.org/privilege/message.write"/>
    <check send_destination="org.ofono" send_interface="org.ofono.MessageManager"
	  send_member="GetMessages" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageManager"
	  receive_member="ImmediateMessage" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageManager"
	  receive_member="IncomingMessage" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageManager"
	  receive_member="MessageAdded" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.MessageManager"
	  receive_member="MessageRemoved" privilege="http://tizen.org/privilege/message.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.Modem" send_member="SetProperty"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.Modem" send_member="GetProperties"
	  privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.Modem"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.NetworkRegistration"
	  send_member="Register" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.NetworkRegistration"
	  send_member="Scan" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.NetworkRegistration"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check send_destination="org.ofono" send_interface="org.ofono.NetworkRegistration"
	  send_member="GetOperators" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.NetworkRegistration"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.NetworkOperator"
	  send_member="Register" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.NetworkOperator"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.NetworkOperator"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.Phonebook" send_member="Import"
	  privilege="http://tizen.org/privilege/contact.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.PushNotification"
	  send_member="RegisterAgent" privilege="http://tizen.org/privilege/message.read"/>
    <check send_destination="org.ofono" send_interface="org.ofono.PushNotification"
	  send_member="UnregisterAgent" privilege="http://tizen.org/privilege/message.read"/>

    <check own="org.ofono.PushNotificationAgent"
	  privilege="http://tizen.org/privilege/message.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.RadioSettings"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.RadioSettings"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.RadioSettings"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.SimManager"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.SimManager"
	  privilege="http://tizen.org/privilege/telephony.admin"/>

    <check send_destination="org.ofono" send_interface="org.ofono.SmartMessaging"
	  send_member="RegisterAgent" privilege="http://tizen.org/privilege/message.read"/>
    <check send_destination="org.ofono" send_interface="org.ofono.SmartMessaging"
	  send_member="UnregisterAgent" privilege="http://tizen.org/privilege/message.read"/>
    <check send_destination="org.ofono" send_interface="org.ofono.SmartMessaging"
	  send_member="SendAppointment" privilege="http://tizen.org/privilege/message.write"/>
    <check send_destination="org.ofono" send_interface="org.ofono.SmartMessaging"
	  send_member="SendBusinessCard" privilege="http://tizen.org/privilege/message.write"/>

    <check own="org.ofono.SmartMessagingAgent" privilege="http://tizen.org/privilege/message.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.SimToolkit"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.SimToolkit"
	  privilege="http://tizen.org/privilege/telephony.admin"/>

    <check own="org.ofono.SimToolkitAgent" privilege="http://tizen.org/privilege/telephony.admin"/>

    <check send_destination="org.ofono" send_interface="org.ofono.SupplementaryServices"
	  privilege="http://tizen.org/privilege/telephony.admin"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.SupplementaryServices"
	  privilege="http://tizen.org/privilege/telephony.admin"/>

    <check send_destination="org.ofono" send_interface="org.ofono.TextTelephony"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.TextTelephony"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/telephony"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.TextTelephony"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/telephony"/>

    <check send_destination="org.ofono" send_interface="org.ofono.VoiceCall"
	  privilege="http://tizen.org/privilege/call"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.VoiceCall"
	  privilege="http://tizen.org/privilege/call"/>

    <check send_destination="org.ofono" send_interface="org.ofono.VoiceCallManager"
	  privilege="http://tizen.org/privilege/call"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.VoiceCallManager"
	  privilege="http://tizen.org/privilege/call"/>

    <check send_destination="org.ofono" send_interface="org.ofono.cdma.ConnectionManager"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/network.set"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.ConnectionManager"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/network.get"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.ConnectionManager"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/network.get"/>

    <check send_destination="org.ofono" send_interface="org.ofono.cdma.MessageManager"
	  send_member="SendMessage" privilege="http://tizen.org/privilege/message.write"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.MessageManager"
	  receive_member="MessageAdded" privilege="http://tizen.org/privilege/message.write"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.MessageManager"
	  receive_member="MessageRemoved" privilege="http://tizen.org/privilege/message.write"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.MessageManager"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.MessageManager"
	  send_member="GetMessages" privilege="http://tizen.org/privilege/message.read"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.MessageManager"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.MessageManager"
	  receive_member="IncomingMessage" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.MessageManager"
	  receive_member="ImmediateMessage" privilege="http://tizen.org/privilege/message.read"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.MessageManager"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/message.read"/>

    <check send_destination="org.ofono" send_interface="org.ofono.cdma.NetworkRegistration"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/network.set"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.NetworkRegistration"
	  send_member="GetProperties" privilege="http://tizen.org/privilege/network.get"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.NetworkRegistration"
	  receive_member="PropertyChanged" privilege="http://tizen.org/privilege/network.get"/>

    <check send_destination="org.ofono" send_interface="org.ofono.cdma.VoiceCallManager"
	  privilege="http://tizen.org/privilege/call"/>
    <check receive_destination="org.ofono" receive_interface="org.ofono.cdma.VoiceCallManager"
	  privilege="http://tizen.org/privilege/call"/>
    <check send_destination="org.ofono" send_interface="org.ofono.cdma.VoiceCallManager"
	  send_member="SetProperty" privilege="http://tizen.org/privilege/telephony.admin"/>
  </policy>

</busconfig>
